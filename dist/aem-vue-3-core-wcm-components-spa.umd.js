(function(c,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("aem-vue-3-editable-components"),require("@adobe/aem-spa-page-model-manager")):typeof define=="function"&&define.amd?define(["exports","vue","aem-vue-3-editable-components","@adobe/aem-spa-page-model-manager"],e):(c=typeof globalThis<"u"?globalThis:c||self,e(c.aemVueCoreWcmComponentsSpa={},c.Vue,c.AemVueEditableComponents,c.AemSpaPageModelManager))})(this,function(c,e,i,b){"use strict";const k={emptyLabel:"Accordion",isEmpty(o){return!o.cqItemsOrder||(o==null?void 0:o.cqItemsOrder.length)===0}},P={emptyLabel:"Container",isEmpty(o){return!o.cqItemsOrder||(o==null?void 0:o.cqItemsOrder.length)===0}},A={emptyLabel:"Experience Fragment",isEmpty(o){return!o.cqItemsOrder||(o==null?void 0:o.cqItemsOrder.length)===0}},q=e.defineComponent({inheritAttrs:!1,__name:"CoreContainer",props:{accessibilityLabel:{type:String},backgroundStyle:{type:String},cqPath:{type:String,default:""},isInEditor:{type:Boolean,default:void 0},layout:{type:String,default:"RESPONSIVE_GRID",validator:o=>["RESPONSIVE_GRID","SIMPLE"].includes(o)},roleAttribute:{type:String},styleSystemElement:{type:String,default:"div"},...i.componentProperties("cmp-container")},setup(o){const n=o,r=e.useAttrs(),p=typeof n.isInEditor<"u"?n.isInEditor:e.inject("isInEditor",b.AuthoringUtils.isInEditor()),_=e.computed(()=>i.componentClassNames(n.baseCssClass,n.appliedCssClassNames,n.cssClassNames,n.containerProps,p,n.aemNoDecoration)),g=e.computed(()=>{var l;return p&&(r==null?void 0:r.allowedComponents)&&((l=r==null?void 0:r.allowedComponents)==null?void 0:l.applicable)});return e.onMounted(()=>{console.log(JSON.stringify(n,null,2))}),(l,h)=>g.value?(e.openBlock(),e.createBlock(e.unref(i.AllowedComponentsContainer),e.normalizeProps(e.mergeProps({key:0},{...n,...e.unref(r)})),null,16)):(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.styleSystemElement||"div"),{key:1,id:n.id,"aria-label":n.accessibilityLabel,class:e.normalizeClass(_.value),role:n.roleAttribute,style:e.normalizeStyle(n.backgroundStyle)},{default:e.withCtx(()=>[o.layout==="RESPONSIVE_GRID"?(e.openBlock(),e.createBlock(e.unref(i.ResponsiveGrid),e.normalizeProps(e.mergeProps({key:0},{...n,...e.unref(r),allowedComponents:{applicable:!1,components:[]},title:""})),null,16)):(e.openBlock(),e.createBlock(e.unref(i.Container),e.normalizeProps(e.mergeProps({key:1},{...n,...e.unref(r)})),null,16))]),_:1},8,["id","aria-label","class","role","style"]))}}),x=["id","data-cmp-single-expansion"],S=["id","data-cmp-expanded"],B=["id","aria-controls","data-cmp-button-id","onClick","onKeydown"],O=["id","aria-labelledby"],N=e.defineComponent({inheritAttrs:!1,__name:"CoreAccordion",props:{cqItems:{type:Object},cqItemsOrder:{type:Array},cqPath:{type:String,default:""},expandedItems:{type:Array,default:()=>[]},headingElement:{type:String,default:"h3"},...i.componentProperties("cmp-accordion")},setup(o){const n=o,r=e.useAttrs(),p=e.inject("isInEditor",b.AuthoringUtils.isInEditor()),_=e.inject("componentMapping",new i.ComponentMapping),g=(()=>{try{return typeof window<"u"}catch{return!1}})(),l=e.ref(null),h=e.ref(-1),d=e.ref(n.expandedItems),u=e.ref(null),y=e.computed(()=>(r==null?void 0:r.singleExpansion)===!0);g&&window.Granite&&window.Granite.author&&window.Granite.author.MessageChannel&&(l.value=new window.Granite.author.MessageChannel("cqauthor",window));const D=e.computed(()=>{const t={};return p&&(t["data-panelcontainer"]="accordion",t["data-cq-data-path"]=n.cqPath||"",t["data-placeholder-text"]="Please drag Accordion item components here"),t}),E=(t,a=n.cqPath)=>{t.data&&t.data.id===a&&t.data.operation==="navigate"&&(h.value=t.data.index)},z=e.computed(()=>i.Utils.getChildComponents(n.cqPath,n.cqItems,n.cqItemsOrder,!0,()=>({}),!1,_)),M=e.computed(()=>i.componentClassNames(n.baseCssClass,n.appliedCssClassNames,n.cssClassNames,n.containerProps,p,n.aemNoDecoration)),f=t=>{const a=u.value.querySelector(`button[data-cmp-button-id="${t}"]`);a&&a.focus()},w=(t,a)=>{const s=d.value.indexOf(t)>-1;if(y.value)d.value=s?[]:[t];else if(s){const m=d.value.indexOf(t);d.value.splice(m,1)}else d.value.push(t);a.target.focus()},L=(t,a,s)=>{const m=u.value.querySelectorAll("button").length-1;switch(a.code){case"ArrowLeft":case"ArrowUp":a.preventDefault(),s>0&&f(s-1);break;case"ArrowRight":case"ArrowDown":a.preventDefault(),s<m&&f(s+1);break;case"Home":a.preventDefault(),f(0);break;case"End":a.preventDefault(),f(m);break;case"Enter":case"Space":a.preventDefault(),w(t,a),f(s);break}},C=t=>d.value.indexOf(t)>-1,R=e.computed(()=>({cqPath:n.cqPath,placeholderClassNames:["new","section"].join(" ")}));return e.watch(y,async(t,a)=>{t!==a&&(d.value=n.expandedItems)}),e.watch(n.expandedItems,async(t,a)=>{t!==a&&(d.value=t)}),e.watch(h,async(t,a)=>{t!==-1&&typeof t<"u"&&a!==t&&n.cqItemsOrder&&(d.value=[n.cqItemsOrder[a]])}),e.onMounted(()=>{l.value&&l.value.subscribeRequestMessage("cmp.panelcontainer",E)}),e.onUnmounted(()=>{l.value&&l.value.unsubscribeRequestMessage("cmp.panelcontainer",E)}),(t,a)=>(e.openBlock(),e.createElementBlock("div",e.mergeProps({id:n.id,ref_key:"accordion",ref:u,class:M.value,"data-cmp-single-expansion":y.value===!0?!0:void 0},D.value),[n.cqItemsOrder&&(n==null?void 0:n.cqItemsOrder.length)>0&&n.cqItems?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(n.cqItemsOrder,(s,m)=>(e.openBlock(),e.createElementBlock("div",{id:`accordion-${n.cqItems[s].id}`,key:`accordion-index-${m}`,class:e.normalizeClass(`${n.baseCssClass}__item`),"data-cmp-expanded":C(s)?!0:void 0},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.headingElement),{class:e.normalizeClass(`${n.baseCssClass}__header`)},{default:e.withCtx(()=>[e.createElementVNode("button",{id:`accordion-${n.cqItems[s].id}-button`,"aria-controls":`accordion-${n.cqItems[s].id}-panel`,class:e.normalizeClass([`${n.baseCssClass}__button`,{[`${n.baseCssClass}__button--expanded`]:C(s)}]),"data-cmp-button-id":m,onClick:I=>w(s,I),onKeydown:I=>L(s,I,m)},[e.createElementVNode("span",{class:e.normalizeClass(`${n.baseCssClass}__title`)},e.toDisplayString(n.cqItems[s]["cq:panelTitle"]),3),e.createElementVNode("span",{class:e.normalizeClass(`${n.baseCssClass}__icon`)},null,2)],42,B)]),_:2},1032,["class"])),e.unref(p)||C(s)?(e.openBlock(),e.createElementBlock("div",{key:0,id:`accordion-${n.cqItems[s].id}-panel`,"aria-labelledby":`accordion-${n.cqItems[s].id}-button`,class:e.normalizeClass(`${n.baseCssClass}__panel ${C(s)?" "+n.baseCssClass+"__panel--expanded":" "+n.baseCssClass+"__panel--hidden"}`),role:"region"},[n.cqItemsOrder?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(z.value[o.cqItemsOrder.indexOf(s)]),{key:0})):e.createCommentVNode("",!0)],10,O)):e.createCommentVNode("",!0)],10,S))),128)):e.createCommentVNode("",!0),e.unref(p)?(e.openBlock(),e.createBlock(e.unref(i.ContainerPlaceholder),e.normalizeProps(e.mergeProps({key:1},R.value)),null,16)):e.createCommentVNode("",!0)],16,x))}}),F="",$=e.defineComponent({__name:"CoreExperienceFragment",setup(o){return(n,r)=>(e.openBlock(),e.createBlock(q,{"is-in-editor":!1}))}}),G="";c.AccordionEditConfig=k,c.ContainerEditConfig=P,c.CoreAccordion=N,c.CoreContainer=q,c.CoreExperienceFragment=$,c.ExperienceFragmentEditConfig=A,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
